CREATE DEFINER=`root`@`%` FUNCTION `CalDiffDateNoH`(date1 DATE, date2 DATE) RETURNS int(11)
    DETERMINISTIC
BEGIN
	RETURN DATEDIFF(date1,date2) - (SELECT COUNT(0) FROM Calendar WHERE CALDate >= DATE_ADD(date2,INTERVAL 1 DAY) AND CALDate <= date1 AND CALType='H'); 
END
